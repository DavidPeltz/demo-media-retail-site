<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Hub - Laptops</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; max-width: 900px; margin: 20px auto; }
        nav { margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        nav a { margin-right: 15px; text-decoration: none; color: #007bff; font-weight: bold; }
        h1 { color: #333; }
        .product { border: 1px solid #ccc; padding: 15px; margin-bottom: 15px; border-radius: 5px; overflow: hidden; }
        .product h2 a { color: #007bff; text-decoration: none; }
        .product-img { max-width: 100px; height: auto; float: left; margin-right: 15px; border-radius: 5px; }
    </style>

    <script>
    window.dataLayer = window.dataLayer || [];
    dataLayer.push({
        'pageType': 'list_view',
        'pageCategory': 'Laptops',
        'productList': [
            { 'id': 'e3', 'sku': 'LPT001', 'name': 'PowerBook Pro 15"', 'price': 1599.00, 'category': 'Laptops' },
            { 'id': 'e4', 'sku': 'LPT002', 'name': 'AirFlow Ultra 13"', 'price': 1199.00, 'category': 'Laptops' },
            { 'id': 'e5', 'sku': 'LPT003', 'name': 'Gamer Rig Z', 'price': 2199.00, 'category': 'Laptops' }
        ]
    });
    </script>
    
    <script>
    // ----------------------------------------------------
    // Site Token: Used directly in the SDK loader
    var site_token = 'demo-media-retail-site';
    // ----------------------------------------------------

    // 1. SDK Loader: Uses the site_token to initialize the tracking platform
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://api.mediarithmics.com/mics.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer', site_token); 

    // 2. Event Payload Preparation
    window.mics = window.mics || [];
    
    var eventProperties = {};
    var eventType = 'Page View';
    
    // Set default page context properties
    eventProperties.page_url = 'demo-media-retail-site.netlify.app' + window.location.pathname;
    eventProperties.page_name = document.title;
    
    if (window.dataLayer && window.dataLayer.length > 0) {
        var dlData = window.dataLayer[window.dataLayer.length - 1]; 
        
        if (dlData.pageType === 'product_view' && dlData.productDetail) {
            eventType = 'Product View';
            // Map product detail fields for the 'Product View' event
            eventProperties.product_id = dlData.productDetail.id;
            eventProperties.product_sku = dlData.productDetail.sku;
            eventProperties.product_name = dlData.productDetail.name;
            eventProperties.product_price = dlData.productDetail.price;
            eventProperties.product_category = dlData.productDetail.category;
            
        } else if (dlData.pageType === 'list_view') {
            eventType = 'Product List View';
            // Map category and product list for the 'Product List View' event
            eventProperties.category_name = dlData.pageCategory;
            eventProperties.product_list = dlData.productList; 
            
        } else {
            eventProperties.page_type = dlData.pageType; 
        }
    }
    
    // 3. Push the 'track' command to the mics array
    mics.push(['track', eventType, eventProperties]);
</script>

</head>
<body>
    <nav>
        <a href="index.html">Home</a>
        <a href="phones.html">Phones</a>
        <a href="laptops.html">Laptops</a>
    </nav>
    <h1>Laptops ðŸ’»</h1>
    <p>This page fires a **'Product List View'** event containing the three laptops listed below.</p>
    
    <div class="product">
        <img src="powerbookpro.png" alt="PowerBook Pro 15 Inch" class="product-img">
        <h2><a href="product-powerbookpro.html">PowerBook Pro 15"</a></h2>
        <p>Price: $1599.00 | SKU: LPT001</p>
        <p>Unmatched power for creative professionals.</p>
    </div>

    <div class="product">
        <img src="airflowultra.png" alt="AirFlow Ultra 13 Inch" class="product-img">
        <h2><a href="product-airflowultra.html">AirFlow Ultra 13"</a></h2>
        <p>Price: $1199.00 | SKU: LPT002</p>
        <p>The ultimate lightweight machine for mobility.</p>
    </div>
    
    <div class="product">
        <img src="gamerrigz.png" alt="Gamer Rig Z" class="product-img">
        <h2><a href="product-gamerrigz.html">Gamer Rig Z</a></h2>
        <p>Price: $2199.00 | SKU: LPT003</p>
        <p>Maximum performance for competitive gaming.</p>
    </div>
</body>
</html>
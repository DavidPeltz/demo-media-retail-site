<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tech Hub - Home</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 20px; max-width: 1000px; margin: 20px auto; background-color: #f7f7f7; color: #333; }
        nav { margin-bottom: 20px; border-bottom: 1px solid #ddd; padding-bottom: 15px; }
        nav a { margin-right: 25px; text-decoration: none; color: #007bff; font-weight: bold; transition: color 0.2s; }
        nav a:hover { color: #0056b3; }
        h1 { color: #222; border-bottom: 2px solid #007bff; padding-bottom: 10px; margin-bottom: 30px; }

        /* New Styling for the Storefront */
        .category-grid {
            display: flex;
            gap: 30px;
            margin-top: 30px;
        }
        .category-card {
            flex: 1;
            padding: 30px;
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        .category-card h2 {
            font-size: 1.8em;
            color: #007bff;
            margin-top: 0;
        }
        .category-card p {
            color: #666;
            margin-bottom: 20px;
        }
        .category-card a {
            display: inline-block;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
        }
    </style>

    <script type="text/javascript">
    /* YOU SHOULD NOT EDIT THIS PART */
    !function(t,e,a){"use strict";var i=t.scimhtiraidem||{};function s(t){var e=i[a]||{};i[a]=e,e[t]||(e[t]=function(){i._queue[a].push({method:t,args:Array.prototype.slice.apply(arguments)})})}t.googletag=t.googletag||{},t.googletag.cmd=t.googletag.cmd||[],t.googletag.cmd.push(function(){var e=t.localStorage.getItem("mics_sgmts"),a=JSON.parse(e),i=a||{};Object.keys(i).forEach(function(e){t.googletag.pubads().setTargeting("mics_"+e,i[e].map(String))})});var r="init call config push pushDefault addIdentifier addProperties addProperty onFinish onStart _reset".split(" ");i._queue=i._queue||{},i._names=i._names||[],i._names.push(a),i._queue[a]=i._queue[a]||[],i._startTime=(new Date).getTime(),i._snippetVersion="2.0";for(var o=0;o<r.length;o++)s(r[o]);t.scimhtiraidem=i,t[a]=i[a];var n=e.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src","https://static.mediarithmics.com/tag/2/tag.min.js"),n.setAttribute("async","true"),e.getElementsByTagName("script")[0].parentNode.appendChild(n)}(window,document,"demomediaretailsite");
    
    // 1. Initialization (Untouched)
    demomediaretailsite.init("demo-media-retail-site");
    
    // Enables client-side feeds
    demomediaretailsite.call("syncFeeds");
    
    /* CUSTOMIZE THE TAG CALL BELOW */
    
    // --- START CUSTOM CODE ---
    
    // 1. ADD CONSENT EVENT using the documented $set_user_choice structure
    var userConsent = {
        $processing_token: "fillet-april", 
        $choice_acceptance_value: true
    };
    // Push the consent event first
    demomediaretailsite.push("$set_user_choice", userConsent);

    // demomediaretailsite.pushDefault(); 

    var eventType = 'Page View';
    
    // Define separate objects for retail event data
    var pageContext = {};
    var productDetails = {};
    var listDetails = {};
    
    // 2. Always define the basic page context
    pageContext.page_url = 'https://demo-media-retail-site.netlify.app' + window.location.pathname;
    pageContext.page_name = document.title;
    
    // Read the page-specific dataLayer content
    if (window.dataLayer && window.dataLayer.length > 0) {
        var dlData = window.dataLayer[window.dataLayer.length - 1]; 
        
        if (dlData.pageType === 'product_view' && dlData.productDetail) {
            eventType = 'Product View';
            
            // Populate Product Detail Object
            productDetails.product_id = dlData.productDetail.id;
            productDetails.product_sku = dlData.productDetail.sku;
            productDetails.product_name = dlData.productDetail.name;
            productDetails.product_price = dlData.productDetail.price;
            productDetails.product_category = dlData.productDetail.category;
            
            pageContext.page_type = dlData.pageType;
            
        } else if (dlData.pageType === 'list_view') {
            eventType = 'Product List View';
            
            // Populate List Detail Object
            listDetails.category_name = dlData.pageCategory;
            listDetails.product_list = dlData.productList; 
            
            pageContext.page_type = dlData.pageType;
            
        } else {
            eventType = 'Page View';
            pageContext.page_type = dlData.pageType; 
        }
    }
    
    // 3. FINAL PUSH LOGIC (Retail Events)
    if (eventType === 'Product View') {
        // Send eventType, Page Context, and Product Details as separate arguments
        demomediaretailsite.push(eventType, pageContext, productDetails);
        
    } else if (eventType === 'Product List View') {
        // Send eventType, Page Context, and List Details as separate arguments
        demomediaretailsite.push(eventType, pageContext, listDetails);
        
    } else {
        // Send eventType and Page Context only
        demomediaretailsite.push(eventType, pageContext);
    }

    // --- END CUSTOM CODE ---
</script>

</head>
<body>
    <nav>
        <a href="index.html">Home</a>
        <a href="phones.html">Phones</a>
        <a href="laptops.html">Laptops</a>
    </nav>
    <h1>Welcome to Tech Hub! âš¡</h1>
    <p>Your destination for the latest in mobile and computing technology. This page fires a **'Page View'** event.</p>
    
    <div class="category-grid">
        
        <div class="category-card">
            <h2>Smartphones ðŸ“±</h2>
            <p>Explore the newest devices with cutting-edge cameras and displays, featuring the Vertex X1 and Alpha 7 Mini.</p>
            <a href="phones.html">View Phones</a>
        </div>
        
        <div class="category-card">
            <h2>Laptops ðŸ’»</h2>
            <p>High-performance machines for professionals and gamers, including the PowerBook Pro and Gamer Rig Z.</p>
            <a href="laptops.html">View Laptops</a>
        </div>
        
    </div>
</body>
</html>